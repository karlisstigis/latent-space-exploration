{"id":"23463d4a-f2b7-4139-9e0e-9b91f770922f","revision":0,"last_node_id":121,"last_link_id":191,"nodes":[{"id":99,"type":"OpenCLIPTextModelLoader","pos":[802.3542507475872,666.712885458113],"size":[306.81493011217935,178.67848024006184],"flags":{},"order":0,"mode":0,"inputs":[{"localized_name":"architecture","name":"architecture","type":"COMBO","widget":{"name":"architecture"},"link":null},{"localized_name":"pretrained","name":"pretrained","type":"COMBO","widget":{"name":"pretrained"},"link":null},{"localized_name":"device","name":"device","type":"COMBO","widget":{"name":"device"},"link":null},{"localized_name":"force_quick_gelu","name":"force_quick_gelu","type":"BOOLEAN","widget":{"name":"force_quick_gelu"},"link":null},{"localized_name":"checkpoint_path","name":"checkpoint_path","type":"STRING","widget":{"name":"checkpoint_path"},"link":null},{"localized_name":"cache_dir","name":"cache_dir","type":"STRING","widget":{"name":"cache_dir"},"link":null}],"outputs":[{"localized_name":"clip_model","name":"clip_model","type":"MODEL","links":[184]}],"properties":{"Node name for S&R":"OpenCLIPTextModelLoader"},"widgets_values":["ViT-B-32","openai","auto",true,"",""],"color":"#232","bgcolor":"#353"},{"id":118,"type":"ClipActivationRecorder","pos":[1171.9140111355828,667.268733603668],"size":[344.3987984367342,280.85636716662907],"flags":{},"order":5,"mode":0,"inputs":[{"localized_name":"clip_model","name":"clip_model","type":"MODEL","link":184},{"localized_name":"dataset","name":"dataset","type":"MODEL","link":183},{"localized_name":"batch_size","name":"batch_size","type":"INT","widget":{"name":"batch_size"},"link":null},{"localized_name":"store_mode","name":"store_mode","type":"COMBO","widget":{"name":"store_mode"},"link":null},{"localized_name":"output_dir","name":"output_dir","type":"STRING","widget":{"name":"output_dir"},"link":null},{"localized_name":"file_prefix","name":"file_prefix","type":"STRING","widget":{"name":"file_prefix"},"link":null},{"localized_name":"dtype","name":"dtype","type":"COMBO","widget":{"name":"dtype"},"link":null},{"localized_name":"capture_profile","name":"capture_profile","type":"COMBO","widget":{"name":"capture_profile"},"link":null},{"localized_name":"overwrite","name":"overwrite","type":"BOOLEAN","widget":{"name":"overwrite"},"link":null},{"localized_name":"gc_interval","name":"gc_interval","type":"INT","widget":{"name":"gc_interval"},"link":null},{"localized_name":"flush_interval","name":"flush_interval","type":"INT","widget":{"name":"flush_interval"},"link":null}],"outputs":[{"localized_name":"activations","name":"activations","type":"MODEL","links":[185,191]},{"localized_name":"output_dir","name":"output_dir","type":"STRING","links":null}],"properties":{"Node name for S&R":"ClipActivationRecorder"},"widgets_values":[64,"disk","clip_activations","","float16","full",false,200,500],"color":"#232","bgcolor":"#353"},{"id":71,"type":"UmapConfig","pos":[1643.044259584999,746.1590050553502],"size":[274.07421875,178],"flags":{},"order":1,"mode":0,"inputs":[{"localized_name":"use_pca","name":"use_pca","type":"BOOLEAN","widget":{"name":"use_pca"},"link":null},{"localized_name":"pca_dim","name":"pca_dim","type":"INT","widget":{"name":"pca_dim"},"link":null},{"localized_name":"use_umap_seed","name":"use_umap_seed","type":"BOOLEAN","widget":{"name":"use_umap_seed"},"link":null},{"localized_name":"umap_random_seed","name":"umap_random_seed","type":"INT","widget":{"name":"umap_random_seed"},"link":null},{"localized_name":"n_neighbors","name":"n_neighbors","type":"INT","widget":{"name":"n_neighbors"},"link":null},{"localized_name":"min_dist","name":"min_dist","type":"FLOAT","widget":{"name":"min_dist"},"link":null}],"outputs":[{"localized_name":"umap_config","name":"umap_config","type":"MODEL","links":[123,189]}],"properties":{"Node name for S&R":"UmapConfig"},"widgets_values":[true,256,true,42,5,0.1],"color":"#323","bgcolor":"#535"},{"id":67,"type":"NeuronUmapBuilder","pos":[2027.0448364731553,662.8468190507461],"size":[372.05324227098424,149.81482487630547],"flags":{},"order":6,"mode":0,"inputs":[{"localized_name":"activations","name":"activations","type":"MODEL","link":185},{"localized_name":"umap_config","name":"umap_config","type":"MODEL","link":123},{"localized_name":"output_dir","name":"output_dir","type":"STRING","widget":{"name":"output_dir"},"link":132},{"localized_name":"file_name","name":"file_name","type":"STRING","widget":{"name":"file_name"},"link":null}],"outputs":[{"localized_name":"coords_csv","name":"coords_csv","type":"STRING","links":null}],"properties":{"Node name for S&R":"NeuronUmapBuilder"},"widgets_values":["","clip_neurons_per_step_coords_3d2d.csv"],"color":"#323","bgcolor":"#535"},{"id":119,"type":"PromptUmapBuilder","pos":[2030.0829742987464,931.4519664257948],"size":[370.421287580421,146],"flags":{},"order":7,"mode":0,"inputs":[{"localized_name":"activations","name":"activations","type":"MODEL","link":191},{"localized_name":"dataset","name":"dataset","type":"MODEL","link":188},{"localized_name":"umap_config","name":"umap_config","type":"MODEL","link":189},{"localized_name":"output_dir","name":"output_dir","type":"STRING","widget":{"name":"output_dir"},"link":190},{"localized_name":"file_name","name":"file_name","type":"STRING","widget":{"name":"file_name"},"link":null},{"localized_name":"write_lookup_table","name":"write_lookup_table","type":"BOOLEAN","widget":{"name":"write_lookup_table"},"link":null}],"outputs":[{"localized_name":"coords_csv","name":"coords_csv","type":"STRING","links":null}],"properties":{"Node name for S&R":"PromptUmapBuilder"},"widgets_values":["","clip_prompts_per_step_coords_3d2d.csv",true],"color":"#323","bgcolor":"#535"},{"id":121,"type":"Note","pos":[1174.627792324677,1024.8500437296714],"size":[340.8424509198155,88],"flags":{},"order":3,"mode":0,"inputs":[],"outputs":[],"properties":{},"widgets_values":["For large .csv files use load mode - \"stream\".\n\nKarlis Stigis\nhttps://karlisstigis.com"],"color":"#432","bgcolor":"#653"},{"id":34,"type":"PrimitiveString","pos":[1645.4600986835665,1017.2713323897428],"size":[270.5555216471355,59.111094156901004],"flags":{},"order":2,"mode":0,"inputs":[{"localized_name":"value","name":"value","type":"STRING","widget":{"name":"value"},"link":null}],"outputs":[{"localized_name":"STRING","name":"STRING","type":"STRING","links":[132,190]}],"title":"OUT Folder","properties":{"cnr_id":"comfy-core","ver":"0.3.76","Node name for S&R":"PrimitiveString"},"widgets_values":["umap"],"color":"#323","bgcolor":"#535"},{"id":117,"type":"PromptDatasetLoader","pos":[801.4412503157132,952.247952414217],"size":[306.878515625,226],"flags":{},"order":4,"mode":0,"inputs":[{"localized_name":"csv_path","name":"csv_path","type":"STRING","widget":{"name":"csv_path"},"link":null},{"localized_name":"load_mode","name":"load_mode","type":"COMBO","widget":{"name":"load_mode"},"link":null},{"localized_name":"start","name":"start","type":"INT","widget":{"name":"start"},"link":null},{"localized_name":"end","name":"end","type":"INT","widget":{"name":"end"},"link":null},{"localized_name":"text_column","name":"text_column","type":"STRING","widget":{"name":"text_column"},"link":null},{"localized_name":"id_column","name":"id_column","type":"STRING","widget":{"name":"id_column"},"link":null},{"localized_name":"source_column","name":"source_column","type":"STRING","widget":{"name":"source_column"},"link":null},{"localized_name":"chunksize","name":"chunksize","type":"INT","widget":{"name":"chunksize"},"link":null}],"outputs":[{"localized_name":"dataset","name":"dataset","type":"MODEL","links":[183,188]}],"properties":{"Node name for S&R":"PromptDatasetLoader"},"widgets_values":["datasets\\prompts_dataset.csv","stream",0,5,"text","prompt_id","source",200000],"color":"#232","bgcolor":"#353"}],"links":[[123,71,0,67,1,"MODEL"],[132,34,0,67,2,"STRING"],[183,117,0,118,1,"MODEL"],[184,99,0,118,0,"MODEL"],[185,118,0,67,0,"MODEL"],[188,117,0,119,1,"MODEL"],[189,71,0,119,2,"MODEL"],[190,34,0,119,3,"STRING"],[191,118,0,119,0,"MODEL"]],"groups":[{"id":1,"title":"Input","bounding":[736.5262149374271,558.3681720205624,841.9846816174997,663.2262376035345],"color":"#3f789e","font_size":24,"flags":{}},{"id":2,"title":"Output","bounding":[1590.9612458937681,558.244575246175,897.1851010728574,663.1625699860598],"color":"#3f789e","font_size":24,"flags":{}}],"config":{},"extra":{"ds":{"scale":0.9825282111410824,"offset":[-114.77694330399633,-404.3419551502523]},"reroutes":[{"id":1,"pos":[1938.4165453609414,678.3792339666326],"linkIds":[185,191]}],"workflowRendererVersion":"LG","linkExtensions":[{"id":185,"parentId":1},{"id":191,"parentId":1}]},"version":0.4}